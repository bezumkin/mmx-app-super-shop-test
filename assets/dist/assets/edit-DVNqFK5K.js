import{V as U,Z as A}from"./vesp-DsepCvKf.js";import{e as I,o as D,m as M,z as N,X as P,u as T,f as q}from"./vue-bootstrap--o-ttebX.js";import{n as L,c as $,y as X,E,T as C,A as Z}from"./api-DjKqTDk2.js";import{d as F,z as k,A as j,B as G,o as d,c as b,q as n,w as s,F as K,p as H,u as y,b as w,i as p,ab as J,a6 as z,m as O}from"./vue-orbdrfsW.js";import{_ as Q}from"./product.vue_vue_type_script_setup_true_lang-CnOQaJPV.js";import{a as S}from"./vue-router-D2KDzTwG.js";const W={class:"text-center"},Y={class:"d-flex justify-content-between pt-1"},ee=p("i",{class:"icon icon-power-off"},null,-1),te=p("i",{class:"icon icon-check fa-fw"},null,-1),oe=p("i",{class:"icon icon-times fa-fw"},null,-1),ae=F({__name:"gallery",props:{productId:{type:Number,required:!0}},setup(B){const r=B,m=k([]),t=k(),c=j(()=>"mgr/product/"+r.productId+"/files");function i(e){if(!/image\//.test(e.type)){L($("errors.gallery.wrong_type"));return}const l={name:e.name,type:e.type,size:e.size},a=new FileReader;a.readAsDataURL(e),a.onload=async function(){try{await X(c.value,{file:a.result,metadata:l}),await o(),t.value.reset()}catch{}},a.onerror=function(f){console.log("Error: ",f)}}async function o(){try{const e=await E(c.value);m.value=e.rows}catch{}}async function v(e){try{await C(c.value+"/"+e.file_id,{active:!1}),await o()}catch{}}async function _(e){try{await C(c.value+"/"+e.file_id,{active:!0}),await o()}catch{}}async function h(e){try{await Z(c.value+"/"+e.file_id),await o()}catch{}}return G(o),(e,l)=>{const a=I,f=D,g=M,x=N,R=P;return d(),b("div",null,[n(a,{ref_key:"fileEl",ref:t,"onUpdate:modelValue":i},null,512),n(R,{class:"mt-3"},{default:s(()=>[(d(!0),b(K,null,H(y(m),u=>(d(),w(x,{key:u.id,cols:"6",md:"4",class:"p-1"},{default:s(()=>[p("div",W,[n(f,{src:e.$image(u.file,{w:150,h:100,fit:"crop"}),width:"150",rounded:""},null,8,["src"])]),p("div",Y,[u.active?(d(),w(g,{key:0,variant:"warning",size:"sm",onClick:V=>v(u)},{default:s(()=>[ee]),_:2},1032,["onClick"])):(d(),w(g,{key:1,size:"sm",variant:"success",onClick:V=>_(u)},{default:s(()=>[te]),_:2},1032,["onClick"])),n(g,{variant:"danger",size:"sm",onClick:V=>h(u)},{default:s(()=>[oe]),_:2},1032,["onClick"])])]),_:2},1024))),128))]),_:1})])}}}),ue=F({__name:"edit",async setup(B){let r,m;const t=k({}),c={url:"mgr/products/"+S().params.id,title:$("models.product.title_one"),updateKey:"mgr-products",method:"patch"};try{t.value=([r,m]=J(()=>E(c.url)),r=await r,m(),r)}catch(i){console.error(i),U()}return(i,o)=>{const v=Q,_=T,h=ae,e=q,l=A;return d(),w(l,O({modelValue:y(t),"onUpdate:modelValue":o[1]||(o[1]=a=>z(t)?t.value=a:null)},c),{"form-fields":s(()=>[n(e,{"content-class":"pt-3"},{default:s(()=>[n(_,{title:i.$t("models.product.title_one")},{default:s(()=>[n(v,{modelValue:y(t),"onUpdate:modelValue":o[0]||(o[0]=a=>z(t)?t.value=a:null)},null,8,["modelValue"])]),_:1},8,["title"]),n(_,{title:i.$t("models.product.gallery")},{default:s(()=>[n(h,{"product-id":y(t).id},null,8,["product-id"])]),_:1},8,["title"])]),_:1})]),_:1},16,["modelValue"])}}});export{ue as default};
